try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/sidebar-ia.js' */
(function(a){Confluence.Sidebar={};AJS.toInit(function(g){var s=g(window);var F=g(document);var w=Math.min(285,s.width()/3);var G=285;var E=150;var t=55;var q=AJS.contextPath();var m=q.length?q:"/";var p=AJS.Meta.get("space-key");var c=AJS.Meta.get("use-keyboard-shortcuts")?" "+"(\u2009[\u2009)":"";Confluence.Sidebar.collapseTooltip="\u6536\u8D77\u4FA7\u8FB9\u680F"+c;Confluence.Sidebar.expandTooltip="\u5C55\u5F00\u4FA7\u8FB9\u680F"+c;var f=g(".ia-splitter").children();var H=g(".ia-splitter-left");if(H.length<1){return}var n=g(".acs-side-bar");var y=H.find(".ia-fixed-sidebar");var d=g("<div>",{"class":"ia-splitter-handle tipsy-enabled","data-tooltip":Confluence.Sidebar.collapseTooltip}).appendTo(y);g("<div>",{"class":"ia-splitter-handle-highlight"}).appendTo(d);var h=g(".ia-secondary-container");var A=g("#footer, #studio-footer");Confluence.Sidebar.throbberDiv=i;h.length&&D(h.attr("data-tree-type"));s.scroll(x);s.resize(x);s.on("touchend",x);F.ready(x);AJS.bind("confluence.header-resized",x);g("#header-precursor img").load(x);Confluence.Sidebar.applyTooltip=u;l();AJS.bind("sidebar.exit-configure-mode",l);var j=g.cookie("confluence-sidebar.width")||w,e=j>E?j:t;k(e);v();y.css("visibility","visible");x();o();Confluence.Sidebar.createFlyouts(n);AJS.trigger("sidebar.finished-loading");AJS.bind("pagetree-children-loaded",function(){var J=g(".plugin_pagetree_current");if(J.length){var K=J.offset();if(K.top>n.height()/2){n.scrollTop(K.top-n.height()/3)}if(K.left>n.width()/2){n.scrollLeft(K.left-n.width()/2)}}});AJS.bind("sidebar.enter-configure-mode",function(){b();I();y.addClass("configure-mode")});AJS.bind("sidebar.exit-configure-mode",function(){b();z();y.removeClass("configure-mode")});function b(){AJS.trigger("sidebar.hide-overlays")}function u(J,L){var K={live:true,gravity:"w",title:"data-tooltip",delayIn:500,delayOut:0,offset:5};g(J).tooltip(L?g.extend(K,L):K)}function l(){g(".acs-side-bar .quick-links-section").attr("data-collapsed-tooltip","\u7A7A\u95F4\u5FEB\u6377\u94FE\u63A5");g("#space-tools-menu-trigger").attr("data-collapsed-tooltip","\u7A7A\u95F4\u7BA1\u7406");if(h.attr("data-tree-type")=="pages"){g(".acs-side-bar .ia-secondary-container").attr("data-collapsed-tooltip","\u5B50\u9875\u9762");u(".collapsed .ia-secondary-container.tipsy-enabled",{title:"data-collapsed-tooltip"})}u(".expand-collapse-trigger");u(".ia-splitter-handle.tipsy-enabled");u(".collapsed .quick-links-section.tipsy-enabled, .collapsed .acs-nav-item > a.tipsy-enabled, .collapsed #space-tools-menu-trigger.tipsy-enabled",{title:"data-collapsed-tooltip"});u(".configure-mode .acs-side-bar-space-info.tipsy-enabled",{title:"data-configure-tooltip"});n.on("mousedown click scroll",b);g(window).on("scroll resize",b);AJS.bind("sidebar.hide-overlays",K);AJS.bind("sidebar.disable-tooltip",L);AJS.bind("sidebar.enable-all-tooltips",J);function L(P,O){var M=g(O).closest(".tipsy-enabled");if(M.size()!=1){return}M.removeClass("tipsy-enabled").addClass("tipsy-disabled").attr("title","");var N=M.data("tipsy");if(N){N.hoverState="out"}K()}function J(){g(".tipsy-disabled").removeClass("tipsy-disabled").addClass("tipsy-enabled")}function K(){g(".tipsy").remove()}}function v(){F.on("mousewheel",".ia-scrollable-section",function(M,N){var L=g(this).scrollTop();var K=g(this).get(0).scrollHeight-g(this).innerHeight()-1;if((N>0&&L<=0)||(N<0&&L>=K)){M.preventDefault()}else{if(g.browser.msie){M.preventDefault();var J=30;g(this).scrollTop(L+(-1*N*J))}}M.stopPropagation()})}function i(){var K=g(Confluence.Templates.Sidebar.throbber()),L=K.find(".spinner"),J=Raphael.spinner(L[0],10,"#666");K.find(".throbber").bind("remove",function(){J()});return K}function D(J){if(J==="blogs"){C(n,r)}else{if(J==="pages"){Confluence.Sidebar.Pages.installHandlers(n)}}}function r(M,N){var L=M.attr("data-group-type");var J=M.attr("data-group-value");var K=q+"/rest/ia/1.0/pagetree/blog/subtree";g.get(K,{spaceKey:p,groupType:L,groupValue:J}).done(N)}function C(J,K){J.delegate(".acs-tree-item > .icon, .acs-tree-item > .node-title","click",function(){var P=g(this);var O=P.parent();var L=O.find("> .icon");if(O.hasClass("opened")){O.children("ul").hide();O.removeClass("opened").addClass("closed");L.removeClass("icon-section-opened").addClass("icon-section-closed")}else{if(O.hasClass("closed")){var M=O.children("ul");if(M.length){M.show()}else{var N=g(Confluence.Templates.Sidebar.treeThrobber());O.append(N);K(O,function(R){var Q=g(Confluence.Templates.Sidebar.pagetreeList({pagetree:R,isSubtree:true}));N.remove();Q.appendTo(O)})}O.removeClass("closed").addClass("opened");L.removeClass("icon-section-closed").addClass("icon-section-opened")}}})}function x(){var J=H.offset().top,K=s.scrollTop(),L=s.scrollLeft();if(K<0){return}if(K>(F.height()-s.height())){return}if(L<0){return}if(L>(F.width()-s.width())){return}y.css({top:Math.max(J-K,0)+"px",left:Math.min(L*-1,0)+"px"})}function B(){A.css("margin-left",y.outerWidth()+"px")}function o(){var M=g("body");var K=false;var L=false;var N=function(O){L=true;O.preventDefault();f.one("selectstart",function(Q){Q.preventDefault()});var P=function(){if(y.width()<=E){k(t)}else{w=y.width()}L=false;M.off("mousemove.ia-splitter")};K=false;M.on("mousemove.ia-splitter",function(Q){if(Confluence.Sidebar.Configure.mode&&Q.pageX<G){return}k(Q.pageX);K=true});M.one("mouseup mouseleave",P)};d.on("mousedown.ia-splitter",function(O){N(O);b()}).click(function(){if(!K){J()}else{K=false}});Confluence.Sidebar.toggle=J;function J(){if(Confluence.Sidebar.Configure.mode){return}var O=y.width();if(O>t){if(O<=E){w=G;k(w)}else{w=O;k(t)}}else{k(w)}}}function k(J){J=Math.max(J,t);g.cookie("confluence-sidebar.width",J,{path:m,expires:365});if(J<=E){y.addClass("collapsed");d.attr("data-tooltip",Confluence.Sidebar.expandTooltip);AJS.trigger("sidebar.collapsed")}else{if(y.hasClass("collapsed")){y.removeClass("collapsed");d.attr("data-tooltip",Confluence.Sidebar.collapseTooltip);AJS.trigger("sidebar.expanded")}}y.width(J);f.eq(1).css("margin-left",J+"px");B()}function I(){if(y.width()<G){Confluence.Sidebar.widthBeforeConfiguring=y.width();k(G)}}function z(){if(Confluence.Sidebar.widthBeforeConfiguring){k(Confluence.Sidebar.widthBeforeConfiguring);Confluence.Sidebar.widthBeforeConfiguring=undefined}}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}


try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/configurable-nav.js' */
(function(a){AJS.Confluence.ConfigurableNav=AJS.RestfulTable.extend({initialize:function(c){var b=this;b.options=a.extend(true,c,{model:AJS.RestfulTable.EntryModel,Collection:Backbone.Collection.extend({url:c.resources.self,model:AJS.RestfulTable.EntryModel}),columns:[{id:"title"}]});b._events=b._events||AJS.RestfulTable.Events;b._event=b._event||AJS.RestfulTable.Events;b.classNames=AJS.RestfulTable.ClassNames;b.dataKeys=AJS.RestfulTable.DataKeys;b.$table=c.$el.addClass(this.classNames.RESTFUL_TABLE).addClass(this.classNames.ALLOW_HOVER).addClass("aui").addClass(b.classNames.LOADING);b.$table.prepend('<colgroup><col span="1" class="aui-restfultable-order"><col span="1"><col span="1" class="aui-restfultable-operations"></colgroup>');b.$tbody=a("<tbody/>");b._models=this._createCollection();b._rowClass=AJS.Confluence.ConfigurableNav.Row;b.editRows=[];b.enableReordering();b._models.bind("remove",function(d){a.each(b.getRows(),function(e,f){if(f.model===d){if(f.hasFocus()&&b._createRow){b._createRow.trigger(b._event.FOCUS)}b.removeRow(f)}})});a.get(b.options.resources.all,function(d){b.populate(d)});Confluence.Sidebar.applyTooltip(".hide-link, .show-link, .delete-link, .toggle-link",{gravity:"ne"})},enableReordering:function(){var b=this;this.$tbody.sortable({handle:"."+this.classNames.DRAG_HANDLE,helper:function(f,c){var d=c.clone(true).addClass(b.classNames.MOVEABLE);d.children().each(function(e){a(this).width(c.children().eq(e).width())});return d},start:function(c,d){var e=d.placeholder.find("td");d.item.addClass(b.classNames.MOVEABLE).children().each(function(f){a(this).width(e.eq(f).width())});d.placeholder.html('<td colspan="'+b.getColumnCount()+'">&nbsp;</td>').css("visibility","visible");b.getRowFromElement(d.item[0]).trigger(b._event.MODAL)},stop:function(c,d){if(jQuery(d.item[0]).is(":visible")){d.item.removeClass(b.classNames.MOVEABLE).children().attr("style","");d.placeholder.removeClass(b.classNames.ROW);b.getRowFromElement(d.item[0]).trigger(b._event.MODELESS)}},update:function(e,g){var c,d,f={},h=b.getRowFromElement(g.item[0]);if(h){if(b.options.reverseOrder){d=g.item.next();if(!d.length){f.position="First"}else{c=b.getRowFromElement(d).model;f.after=c.url()}}else{d=g.item.prev();if(!d.length){f.position="First"}else{c=b.getRowFromElement(d).model;f.after=c.url()}}f.spaceKey=AJS.Meta.get("space-key");a.ajax({url:h.model.url()+"/move",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(f),complete:function(){h.hideLoading()},success:function(i){AJS.triggerEvtForInst(b._event.REORDER_SUCCESS,b,[i])},error:function(j){var i=a.parseJSON(j.responseText||j.data);AJS.triggerEvtForInst(b._event.SERVER_ERROR,b,[i,j])}});h.showLoading()}},axis:"y",delay:0,containment:"document",cursor:"move",scroll:true,zIndex:8000});this.$tbody.bind("selectstart mousedown",function(c){return !a(c.target).is("."+b.classNames.DRAG_HANDLE)})}});AJS.Confluence.ConfigurableNav.ReadView=AJS.RestfulTable.CustomReadView.extend({render:function(b){return _.template('<span class="acs-nav-item-link" title="<%=title%>"><span class="icon"></span><span class="acs-nav-item-label"><%=title%></span></span>',{title:AJS.escapeHtml(b.title)})}});AJS.Confluence.ConfigurableNav.Row=AJS.RestfulTable.Row.extend({render:function(){var b=this,d=this.model.toJSON(),e=a("<td class='aui-restfultable-operations' />").append(this.renderOperations(d.canHide,d.hidden)),c=a('<td class="'+this.classNames.ORDER+'"/>').append(this.renderDragHandle());b._event=b._event||b._events;b.$el.attr("data-id",this.model.id);b.$el.append(c);a.each(b.columns,function(f,g){var h,k=a("<td />"),j=d[g.id];if(j){b.$el.attr("data-"+g.id,j)}h=new AJS.Confluence.ConfigurableNav.ReadView().render(d);k.append(h);b.$el.append(k)});b.$el.append(e);d.canHide&&d.hidden&&b.$el.addClass("hidden-link");b.$el.addClass(this.classNames.ROW+" "+b.classNames.READ_ONLY+" acs-nav-item "+d.styleClass);b.trigger(this._event.RENDER,this.$el,d);b.$el.trigger(this._event.CONTENT_REFRESHED,[b.$el]);return b},renderOperations:function(f,e){var c=this,b=a('<a href="#" class="aui-icon aui-icon-small"/>');if(f){function d(g){if(g.hasClass("hide-link")){g.attr("data-tooltip","\u9690\u85CF\u94FE\u63A5")}else{g.attr("data-tooltip","\u663E\u793A\u94FE\u63A5")}}b.addClass(e?"show-link":"hide-link").click(function(g){g.preventDefault();a.ajax({url:c.model.url()+(e?"/show":"/hide"),type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({spaceKey:AJS.Meta.get("space-key")})}).done(function(){b.closest(".acs-nav-item").toggleClass("hidden-link");b.toggleClass("hide-link").toggleClass("show-link");d(b)})});d(b)}else{b.addClass("delete-link tipsy-enabled").click(function(g){g.preventDefault();if(a(".acs-nav").data("quick-links-state")!="hide"){AJS.trigger("sidebar.disable-tooltip",this);c.destroy()}}).attr("data-tooltip","\u5220\u9664\u94FE\u63A5")}return b},destroy:function(){this.model.destroy({data:{spaceKey:AJS.Meta.get("space-key")}})}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}


try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/sidebar-pages.js' */
(function(b){var a=AJS.Meta.get("context-path");Confluence.Sidebar.Pages={installHandlers:function(d){d.find(".more-children-link").click(function(f){f.preventDefault();d.find("ul.more-children").show();b(this).hide()})},quickLinksContent:function(){return new b.Deferred().resolve(b(".acs-side-bar .quick-links-wrapper").html())},childPageCollapsedContent:function(){var e=b(".acs-side-bar .ia-secondary-header");var d=b(".acs-side-bar .ia-secondary-parent-content");var g=b(".acs-side-bar .ia-secondary-current-content");var f=b(".acs-side-bar .ia-secondary-content");return new b.Deferred().resolve(b("<div>").append(b("<div>").addClass("acs-side-bar-flyout-wiki-wrapper").append(e.clone()).append(d.clone()).append(g.clone()).append(f.clone())).html())},pageTreeCollapsedContent:function(){var d=b(".page-tree-flyout-content");if(d.length==0){return c().pipe(function(e){var f=b("<div>").addClass("acs-side-bar-flyout-wiki-wrapper").append(Confluence.Templates.Sidebar.Pages.renderPageContextualNav({pageContextualNav:e,hasCreatePermission:b(".acs-nav").data("has-create-permission")}));b("body").append(b("<div>").addClass("page-tree-flyout-content hidden").append(f.clone()));return f})}else{return new b.Deferred().resolve(d.html())}}};function c(){return b.ajax({url:a+"/rest/ia/1.0/space/childPagesContextualNav",data:{pageId:AJS.Meta.get("page-id")}})}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}


try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/sidebar-links.js' */
AJS.$(function(b){Confluence.Sidebar.Configure={mode:false};var m=AJS.Meta.get("context-path"),k=AJS.Meta.get("space-key"),i=b(".acs-side-bar"),p=i.find(".ia-secondary-container"),t=i.find(".project-shortcut-dialog-trigger"),c,o,j,l,g=b(".acs-nav");b.ajaxSetup({cache:false});b("body").on("click","#acs-configure-link, a.configure-sidebar",function(u){u.preventDefault();s()});function s(){l=g.data("nav-type");Confluence.Sidebar.Configure.mode=true;j=b(".acs-nav-sections .acs-nav-item.current-item").data("collector-key");c=Confluence.Sidebar.throbberDiv();c.height(b(".acs-nav-sections").height());b(".acs-nav-sections").replaceWith(c);p.hide();o=b(Confluence.Templates.Sidebar.configure({pageTree:l=="page-tree",quickLinksState:g.data("quick-links-state")})).hide();c.after(o);d(false);h();f();q();var v={};var u=function(){c.replaceWith(o);o.show()};b("#acs-nav-list-main").one(AJS.RestfulTable.Events.INITIALIZED,function(){v.main=true;v.quick&&u()});b("#acs-nav-list-quick").one(AJS.RestfulTable.Events.INITIALIZED,function(){v.quick=true;v.main&&u()});b(".acs-nav-type").change(function(w){r("nav-type",b(this).val(),function(x){p.data("tree-type",x);g.data("nav-type",x)})});b(".acs-done-link").click(function(w){w.preventDefault();b(".acs-done-link").attr("aria-disabled",true).prop("disabled",true);n()});b(".quick-links-header a").click(function(x){x.preventDefault();var w=g.data("quick-links-state")=="hide"?"show":"hide";r("quick-links-state",w,a)});Confluence.Sidebar.Configure.Logo.bind();AJS.trigger("sidebar.enter-configure-mode")}function r(u,v,w){b.ajax({url:m+"/rest/ia/1.0/space/option",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({spaceKey:k,option:u,value:v}),success:function(x){w(v)}})}function n(){if(l!==g.data("nav-type")){location.reload();return}c=Confluence.Sidebar.throbberDiv();c.height(o.height());o.replaceWith(c);d(true);e();p.show().css("display","");var u=function(){var w=b(Confluence.Templates.Sidebar.renderLinks({mainLinks:v.main,quickLinks:v.quick.reverse(),advancedLinks:v.advanced,hasConfigurePermission:true,collectorToHighlight:j,quickLinksState:g.data("quick-links-state")}));c.replaceWith(w);Confluence.Sidebar.Configure.mode=false;AJS.trigger("sidebar.exit-configure-mode")};var v={};b.get(m+"/rest/ia/1.0/link/main",{spaceKey:k,includeHidden:false}).done(function(w){v.main=w;v.quick&&v.advanced&&u()});b.get(m+"/rest/ia/1.0/link/quick",{spaceKey:k}).done(function(w){v.quick=w;v.main&&v.advanced&&u()});b.get(m+"/rest/ia/1.0/link/advanced",{spaceKey:k}).done(function(w){v.advanced=w;v.main&&v.quick&&u()});Confluence.Sidebar.Configure.Logo.unbind()}function h(){var u=new b.Deferred();b(".acs-add-link").click(function(v){u.done(function(){v.preventDefault();if(g.data("quick-links-state")!="hide"){Confluence.Sidebar.LinkAdapter.hijackLinkBrowser();Confluence.Editor.LinkBrowser.open();b("#recentlyviewed-panel-id").click()}})});if(AJS.Meta.get("space-key")){AJS.Confluence.EditorLoader.load(function(){u.resolve()},function(){AJS.log("Attempted to load editor for space ia side bar. Loading the editor failed.");u.reject()})}else{u.resolve()}}function f(){var u=b("#acs-nav-list-quick");var w=b(".acs-nav-sections .tip").hide();var v=function(){if(Confluence.Sidebar.Configure.QuickLinks.isEmpty()){u.hide();w.show()}else{w.hide();u.show()}};AJS.bindEvt(AJS.RestfulTable.Events.INITIALIZED,v);AJS.bindEvt(AJS.RestfulTable.Events.ROW_ADDED,v);AJS.bindEvt(AJS.RestfulTable.Events.ROW_REMOVED,v)}function q(){Confluence.Sidebar.Configure.MainLinks=new AJS.Confluence.ConfigurableNav({$el:b("#acs-nav-list-main"),resources:{all:m+"/rest/ia/1.0/link/main?spaceKey="+k+"&includeHidden=true",self:m+"/rest/ia/1.0/link"}});Confluence.Sidebar.Configure.QuickLinks=new AJS.Confluence.ConfigurableNav({$el:b("#acs-nav-list-quick"),resources:{all:m+"/rest/ia/1.0/link/quick?spaceKey="+k,self:m+"/rest/ia/1.0/link"},reverseOrder:true})}function e(){Confluence.Sidebar.Configure.MainLinks.remove();Confluence.Sidebar.Configure.MainLinks.unbind();Confluence.Sidebar.Configure.QuickLinks.remove();Confluence.Sidebar.Configure.QuickLinks.unbind();b(AJS).unbind(AJS.RestfulTable.Events.INITIALIZED);b(AJS).unbind(AJS.RestfulTable.Events.ROW_ADDED);b(AJS).unbind(AJS.RestfulTable.Events.ROW_REMOVED)}function d(u){t.length&&t.toggleClass("project-shortcut-dialog-trigger",u)}function a(u){g.data("quick-links-state",u);if(u=="hide"){b(".acs-nav-list-quick-section").addClass("hidden-section")}else{b(".acs-nav-list-quick-section").removeClass("hidden-section")}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}


try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/sidebar-space-tools.js' */
AJS.toInit(function(f){var a=[];var d=[];var e;var h;var b;var g=f.browser.msie&&parseInt(f.browser.version,10)<=8;f("#space-tools-web-items div").each(function(){a.push({label:f(this).data("label"),href:f(this).data("href")})});f("#space-tools-menu-additional-items div").each(function(){d.push({className:f(this).data("class"),label:f(this).data("label"),href:f(this).data("href")})});h={hideDelay:null,width:170,displayShadow:false,calculatePositions:function(i,j){var k=j.target.offset();return{popupCss:{top:k.top-i.height(),left:k.left},arrowCss:{display:"none"}}},hideCallback:function(){AJS.trigger("sidebar.enable-all-tooltips")}};e=AJS.InlineDialog(f("#space-tools-menu-trigger"),"space-tools",function(j,i,k){j.html(Confluence.Templates.Sidebar.spaceToolsMenu({spaceToolLinks:a,spaceLinks:d}));f(i).one("click",function(l){if(f("#inline-dialog-space-tools").is(":visible")){setTimeout(function(){e.hide()},0)}});AJS.trigger("sidebar.disable-tooltip",i);AJS.trigger("sidebar.spacetools-loaded");k();return false},h);e.addClass("aui-dropdown2 aui-style-default");AJS.bind("sidebar.hide-overlays",e.hide);b=f(".expand-collapse-trigger");b.click(function(i){i.preventDefault();Confluence.Sidebar.toggle()});b.attr("data-tooltip",f(".ia-fixed-sidebar").hasClass("collapsed")?Confluence.Sidebar.expandTooltip:Confluence.Sidebar.collapseTooltip);AJS.bind("sidebar.collapsed",function(){b.attr("data-tooltip",Confluence.Sidebar.expandTooltip);c()});AJS.bind("sidebar.expanded",function(){b.attr("data-tooltip",Confluence.Sidebar.collapseTooltip);c()});c();function c(){if(g){f("#space-tools-menu-trigger").toggleClass("force-redraw")}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}


try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/sidebar-flyouts.js' */
(function(d){var b,c,a;Confluence.Sidebar.createFlyouts=function(h){b=g(d(".collapsed .quick-links-section"),Confluence.Sidebar.Pages.quickLinksContent,"sidebar-quick-links-flyout",{flyout:"quick-links"});var i=h.find(".ia-secondary-container");if(i.length&&i.attr("data-tree-type")=="pages"){c=g(d(".collapsed .ia-secondary-header-title.wiki"),Confluence.Sidebar.Pages.childPageCollapsedContent,"sidebar-children-flyout",{flyout:"children"})}if(i.length&&i.attr("data-tree-type")=="page-tree"){a=g(d(".collapsed .ia-secondary-header-title.page-tree"),Confluence.Sidebar.Pages.pageTreeCollapsedContent,"sidebar-page-tree-flyout",{flyout:"pagetree"})}};function g(h,k,j,m){var l=function(o,n,p){d(o).addClass("acs-side-bar-flyout ia-scrollable-section");d(o).empty().append(Confluence.Sidebar.throbberDiv());k().done(function(q){d(o).html(q)});AJS.trigger("sidebar.flyout-triggered",m);p();d(n).one("click",function(q){if(d("#inline-dialog-"+j).is(":visible")){setTimeout(function(){i.hide()},0)}});AJS.trigger("sidebar.disable-tooltip",n)};var i=AJS.InlineDialog(h,j,l,{getArrowPath:e,calculatePositions:f,useLiveEvents:true,hideDelay:null,hideCallback:function(){AJS.trigger("sidebar.enable-all-tooltips")}});AJS.bind("sidebar.hide-overlays",i.hide);return i}function f(i,l,q,h){var r=l.target.offset();var p=l.target.width();var m=l.target.height();var o={top:r.top+m/2-15,left:r.left+p+5,right:"auto"};var j=d(window);var n=20;o.maxHeight=j.height()+j.scrollTop()-o.top-n;if(d.browser.msie&&parseInt(d.browser.version,10)<=8){o.maxHeight-=40}var k={top:9,left:-7};return{displayAbove:false,popupCss:o,arrowCss:k}}function e(){return"M8,16 L0,8,8,0"}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}


try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/external/jquery.mousewheel.min.js' */
/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
(function(a){function d(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=!0,g=0,h=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),h=e,c.axis!==undefined&&c.axis===c.HORIZONTAL_AXIS&&(h=0,g=-1*e),c.wheelDeltaY!==undefined&&(h=c.wheelDeltaY/120),c.wheelDeltaX!==undefined&&(g=-1*c.wheelDeltaX/120),d.unshift(b,e,g,h),(a.event.dispatch||a.event.handle).apply(this,d)}var b=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var c=b.length;c;)a.event.fixHooks[b[--c]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=b.length;a;)this.addEventListener(b[--a],d,!1);else this.onmousewheel=d},teardown:function(){if(this.removeEventListener)for(var a=b.length;a;)this.removeEventListener(b[--a],d,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}


try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/link-browser-adapter.js' */
(function(a){Confluence.Sidebar.LinkAdapter={setLink:function(d){var c=AJS.Meta.get("context-path");var e=Confluence.unescapeEntities(d.getHtml());var b={spaceKey:AJS.Meta.get("space-key"),resourceId:d.attrs["data-linked-resource-id"],resourceType:d.attrs["data-linked-resource-type"],customTitle:e==d.getDefaultAlias()?"":e,url:d.attrs.href};a.ajax({type:"POST",url:c+"/rest/ia/1.0/link",data:a.toJSON(b),dataType:"json",contentType:"application/json",success:function(f){AJS.Confluence.Sidebar.Configure.QuickLinks.addRow({id:f.id,title:f.title,styleClass:f.styleClass,canHide:f.canHide,hidden:f.hidden})}})},getLink:function(){return Confluence.Link.fromData({attrs:{},body:{isEditable:true,isImage:false,html:"",imgName:"",text:""}})},hijackedLinkBrowser:false,hijackLinkBrowser:function(){var b=Confluence.Sidebar.LinkAdapter;if(!b.hijackedLinkBrowser){b.storeBookmark=AJS.Rte.BookmarkManager.storeBookmark;b.restoreBookmark=AJS.Rte.BookmarkManager.restoreBookmark;AJS.Rte.BookmarkManager.storeBookmark=a.noop;AJS.Rte.BookmarkManager.restoreBookmark=a.noop;b.oldLinkAdapter=Confluence.Editor.LinkAdapter;Confluence.Editor.LinkAdapter=b;b.$oldTabItems=a("#link-browser-tab-items div");b.$oldTabItems.each(function(){console.log("while iterating over tab items: "+a(this));var c=a(this).text();if(c!="search"&&c!="recentlyviewed"&&c!="weblink"){a(this).remove()}});b.hijackedLinkBrowser=true}},releaseLinkBrowser:function(){var b=Confluence.Sidebar.LinkAdapter;if(b.hijackedLinkBrowser){AJS.Rte.BookmarkManager.storeBookmark=b.storeBookmark;AJS.Rte.BookmarkManager.restoreBookmark=b.restoreBookmark;a("#link-browser-tab-items").empty().append(b.$oldTabItems);Confluence.Editor.LinkAdapter=b.oldLinkAdapter;b.hijackedLinkBrowser=false}}};AJS.bind("closed.link-browser",function(){if(Confluence.Sidebar.LinkAdapter.hijackedLinkBrowser){Confluence.Sidebar.LinkAdapter.releaseLinkBrowser()}});AJS.bind("updated.link-browser-recently-viewed",function(){var c=AJS.Meta.get("page-title"),b=AJS.Meta.get("space-name");if(c&&b){a("#insert-link-dialog .recently-viewed-panel .data-table tr").each(function(){var d=a(this);if(d.find(".title-field").text()==c&&d.find(".space-field").text()==b){d.click()}})}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}


try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/sidebar-logo.js' */
AJS.$(function(g){Confluence.Sidebar.Configure.Logo={};var e=AJS.Meta.get("context-path"),f=AJS.Meta.get("space-key");Confluence.Sidebar.Configure.Logo.bind=function(){g(".acs-side-bar-space-info").on("click.configurelogo",function(i){h();i.preventDefault();return false})};Confluence.Sidebar.Configure.Logo.unbind=function(){g("#inline-dialog-space-logo-config .cancel").click();g(".acs-side-bar-space-info").off("click.configurelogo")};var c,a,d=g(".acs-side-bar-space-info div.name a").text(),b=false;function h(){var k=function(t,s,v){var r=g("#logoType").val();var u=g("img.avatar-img").attr("src");g(t).addClass("acs-side-bar-flyout");g(t).empty();t.html(AJS.template.load("logo-config-content").fill({spaceName:d}));o(r,u,r,u);q(r);b=false;t.unbind("mouseover mouseout");AJS.trigger("sidebar.disable-tooltip",s);v()};a=false;if(!c){c=AJS.InlineDialog(g(".acs-side-bar-space-info"),"space-logo-config",k,{getArrowPath:p,calculatePositions:l,useLiveEvents:true,preHideCallback:function(){return a},hideCallback:function(){AJS.trigger("sidebar.enable-all-tooltips")},hideDelay:null,noBind:true,width:635})}function l(s,u,y,r){var z=u.target.offset();var x=u.target.width();var v=u.target.height();var w={top:z.top+v/2-15,left:z.left+x+5,right:"auto"};var t={top:9,left:-7};return{displayAbove:false,popupCss:w,arrowCss:t}}function p(){return"M8,16 L0,8,8,0"}c.show();function q(r){if(r){g("#reset-logo").parent().toggleClass("hidden",r!=="custom")}}function o(w,t,v,r){var s=g("#logoType");var u=g("img.avatar-img");if(w){s.val(w)}if(t){u.attr("src",encodeURI(t));u.hide(0,function(){u.show()});q(w)}if(v){s.attr("data-last-value",v)}if(r){u.attr("data-last-value",r)}}g("#reset-logo").click(function(){g.ajax({dataType:"json",contentType:"application/json",url:e+"/rest/ia/1.0/space/defaultLogo.json",error:function(r){j("\u4E0A\u4F20logo\u65F6\u53D1\u751F\u9519\u8BEF")},success:function(s,t,u,r){o("default",e+s.logoDownloadPath);b=true;g("#image-holder").empty();if(g.browser.msie){g("#upload-logo-input").replaceWith(g("#upload-logo-input").clone(true))}else{g("#upload-logo-input").val("")}}})});g("#inline-dialog-space-logo-config .cancel").click(function(){var r=g("#logoType").attr("data-last-value");var s=g("img.avatar-img").attr("data-last-value");o(r,s,r,s);b=false;a=true;c.hide()});g("#inline-dialog-space-logo-config .save").click(function(){var r=g("#crop-photo-form"),s=g(this);s.text("\u6B63\u5728\u4FDD\u5B58...");g.ajax({type:"POST",dataType:"json",contentType:"application/json",data:AJS.$.toJSON({spaceKey:g("#spaceKey",r).val(),spaceName:g("#spaceName",r).val(),offsetX:g("#avatar-offsetX",r).val(),offsetY:g("#avatar-offsetY",r).val(),width:g("#avatar-width",r).val(),logoType:g("#logoType",r).val()+(b?"":"-current")}),url:e+"/rest/ia/1.0/space/setLogo.json",resetForm:false,error:function(t){j("\u4E0A\u4F20logo\u65F6\u53D1\u751F\u9519\u8BEF")},success:function(u,v,w,t){o(u.logoType,e+u.logoDownloadPath,u.logoType,e+u.logoDownloadPath);b=false;d=u.name;$spaceTitle=g(".acs-side-bar-space-info div.name a");$spaceTitle.attr("title",d);$spaceTitle.text(d);a=true;c.hide()},complete:function(){s.text("\u4FDD\u5B58")}})});g("#upload-logo-form").ajaxForm();g("#crop-photo-form").ajaxForm();g("#upload-logo-input").change(function(r){g(this).val()&&g("#upload-logo-form").ajaxSubmit({dataType:"text",data:{contentId:"upload-logo-input"},url:e+"/rest/ia/1.0/space/uploadLogo",resetForm:false,beforeSubmit:function(){var s=g("#image-holder");s.html('<div class="loading-area"><span class="throbber"></span> <span class="upload-text"></span> </div>');var u=s.find(".throbber");var t=Raphael.spinner(u[0],7,"#666");u.bind("remove",t);g(".upload-text",s).text("\u6B63\u5728\u4E0A\u4F20...")},error:function(s){g("#image-holder").empty();j("\u4E0A\u4F20logo\u65F6\u53D1\u751F\u9519\u8BEF")},success:function(t,u,v,s){t=g.parseJSON(t);if(t&&t.downloadPath){m(e+t.downloadPath);o("custom");b=true}else{g("#image-holder").empty();if(t&&t.errorMessage){j(t.errorMessage)}else{j("\u4E0A\u4F20logo\u65F6\u53D1\u751F\u9519\u8BEF")}}}})});function m(s){var u=g("#image-holder");var t=g("<img>",{id:"uploaded-space-logo",src:s}).hide();var x=48;var w=g("#avatar-offsetX"),v=g("#avatar-offsetY"),r=g("#avatar-width");w.val("-1");v.val("-1");r.val("-1");t.load(function(){if(t.height()<x||t.width()<x){n(t)}else{i(t,x,w,v,r);t.trigger("load.jcloader")}});u.empty().append(t)}function n(r){r.show().wrap('<div class="small-logo-container"><div class="small-logo-wrapper"></div></div>')}function i(s,w,v,u,r){function t(x){v.val(Math.floor(x.x));u.val(Math.floor(x.y));r.val(Math.floor(x.w))}s.Jcrop({setSelect:[10,10,100,100],minSize:[w,w],boxWidth:450,boxHeight:400,aspectRatio:1,bgOpacity:0.5,onSelect:t,onChange:t,drawBorders:false,createHandles:["n","e","s","w"],allowSelect:false})}function j(r){AJS.messages.error("#sidebar-logo-messages",{title:r});g("#sidebar-logo-messages .icon-close").on("click",function(s){s.stopPropagation()})}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}


try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/external/jquery.jcrop.js' */
(function(a){a.Jcrop=function(e,E){var L=a.extend({},a.Jcrop.defaults),ah,av,aj=false;function n(aw){return aw+"px"}function G(aw){return L.baseClass+"-"+aw}function H(){return a.fx.step.hasOwnProperty("backgroundColor")}function I(aw){var ax=a(aw).offset();return[ax.left,ax.top]}function J(aw){return[(aw.pageX-ah[0]),(aw.pageY-ah[1])]}function D(aw){if(typeof(aw)!=="object"){aw={}}L=a.extend(L,aw);a.each(["onChange","onSelect","onRelease","onDblClick"],function(ax,ay){if(typeof(L[ay])!=="function"){L[ay]=function(){}}})}function g(ay,aA){ah=I(at);S.setCursor(ay==="move"?ay:ay+"-resize");if(ay==="move"){return S.activateHandlers(U(aA),r)}var aw=ad.getFixed();var ax=t(ay);var az=ad.getCorner(t(ax));ad.setPressed(ad.getCorner(ax));ad.setCurrent(az);S.activateHandlers(K(ay,aw),r)}function K(ax,aw){return function(ay){if(!L.aspectRatio){switch(ax){case"e":ay[1]=aw.y2;break;case"w":ay[1]=aw.y2;break;case"n":ay[0]=aw.x2;break;case"s":ay[0]=aw.x2;break}}else{switch(ax){case"e":ay[1]=aw.y+1;break;case"w":ay[1]=aw.y+1;break;case"n":ay[0]=aw.x+1;break;case"s":ay[0]=aw.x+1;break}}ad.setCurrent(ay);Z.update()}}function U(ax){var aw=ax;ar.watchKeys();return function(ay){ad.moveOffset([ay[0]-aw[0],ay[1]-aw[1]]);aw=ay;Z.update()}}function t(aw){switch(aw){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function c(aw){return function(ax){if(L.disabled){return false}if((aw==="move")&&!L.allowMove){return false}ah=I(at);s=true;g(aw,J(ax));ax.stopPropagation();ax.preventDefault();return false}}function X(aA,ax,az){var aw=aA.width(),ay=aA.height();if((aw>ax)&&ax>0){aw=ax;ay=(ax/aA.width())*aA.height()}if((ay>az)&&az>0){ay=az;aw=(az/aA.height())*aA.width()}P=aA.width()/aw;f=aA.height()/ay;aA.width(Math.floor(aw)).height(Math.floor(ay))}function ab(aw){return{x:aw.x*P,y:aw.y*f,x2:aw.x2*P,y2:aw.y2*f,w:aw.w*P,h:aw.h*f}}function r(ax){var aw=ad.getFixed();if((aw.w>L.minSelect[0])&&(aw.h>L.minSelect[1])){Z.enableHandles();Z.done()}else{Z.release()}S.setCursor(L.allowSelect?"crosshair":"default")}function ag(aw){if(L.disabled){return false}if(!L.allowSelect){return false}s=true;ah=I(at);Z.disableHandles();S.setCursor("crosshair");var ax=J(aw);ad.setPressed(ax);Z.update();S.activateHandlers(aq,r);ar.watchKeys();aw.stopPropagation();aw.preventDefault();return false}function aq(aw){ad.setCurrent(aw);Z.update()}function ai(){var ax=a("<div></div>").addClass(G("tracker"));if(a.browser.msie){var aw=a("<div></div>");aw.css({opacity:0,backgroundColor:"white",height:"100%",width:"100%"});ax.append(aw)}return ax}if(a.browser.msie&&(a.browser.version.split(".")[0]==="6")){aj=true}if(typeof(e)!=="object"){e=a(e)[0]}if(typeof(E)!=="object"){E={}}D(E);var j={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0};var aa=a(e),al=true;if(e.tagName=="IMG"){if(aa[0].width!=0&&aa[0].height!=0){aa.width(aa[0].width);aa.height(aa[0].height)}else{var w=new Image();w.src=aa[0].src;aa.width(w.width);aa.height(w.height)}var at=aa.clone().removeAttr("id").css(j).show();at.width(aa.width());at.height(aa.height());aa.after(at).hide()}else{at=aa.css(j).show();al=false;if(L.shade===null){L.shade=true}}X(at,L.boxWidth,L.boxHeight);var T=at.width(),R=at.height(),ac=a("<div />").width(T).height(R).addClass(G("holder")).css({position:"relative",backgroundColor:L.bgColor}).insertAfter(aa).append(at);if(L.addClass){ac.addClass(L.addClass)}var M=a("<div />"),m=a("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),O=a("<div />").width("100%").height("100%").css("zIndex",320),C=a("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var aw=ad.getFixed();L.onDblClick.call(i,aw)}).insertBefore(at).append(m,O);if(al){M=a("<img />").attr("src",at.attr("src")).css(j).width(T).height(R),m.append(M)}if(aj){C.css({overflowY:"hidden"})}var v=L.boundary;var b=ai().width(T+(v*2)).height(R+(v*2)).css({position:"absolute",top:n(-v),left:n(-v),zIndex:290}).mousedown(ag);var ap=L.bgColor,ae=L.bgOpacity,B,an,q,W,P,f,p=true,s,F,af;ah=I(at);var V=(function(){function aw(){var aD={},aB=["touchstart","touchmove","touchend"],aC=document.createElement("div"),aA;try{for(aA=0;aA<aB.length;aA++){var ay=aB[aA];ay="on"+ay;var az=(ay in aC);if(!az){aC.setAttribute(ay,"return;");az=typeof aC[ay]=="function"}aD[aB[aA]]=az}return aD.touchstart&&aD.touchend&&aD.touchmove}catch(aE){return false}}function ax(){if((L.touchSupport===true)||(L.touchSupport===false)){return L.touchSupport}else{return aw()}}return{createDragger:function(ay){return function(az){az.pageX=az.originalEvent.changedTouches[0].pageX;az.pageY=az.originalEvent.changedTouches[0].pageY;if(L.disabled){return false}if((ay==="move")&&!L.allowMove){return false}s=true;g(ay,J(az));az.stopPropagation();az.preventDefault();return false}},newSelection:function(ay){ay.pageX=ay.originalEvent.changedTouches[0].pageX;ay.pageY=ay.originalEvent.changedTouches[0].pageY;return ag(ay)},isSupported:aw,support:ax()}}());var ad=(function(){var ay=0,aJ=0,ax=0,aI=0,aB,az;function aD(aM){aM=aA(aM);ax=ay=aM[0];aI=aJ=aM[1]}function aC(aM){aM=aA(aM);aB=aM[0]-ax;az=aM[1]-aI;ax=aM[0];aI=aM[1]}function aL(){return[aB,az]}function aw(aO){var aN=aO[0],aM=aO[1];if(0>ay+aN){aN-=aN+ay}if(0>aJ+aM){aM-=aM+aJ}if(R<aI+aM){aM+=R-(aI+aM)}if(T<ax+aN){aN+=T-(ax+aN)}ay+=aN;ax+=aN;aJ+=aM;aI+=aM}function aE(aM){var aN=aK();switch(aM){case"ne":return[aN.x2,aN.y];case"nw":return[aN.x,aN.y];case"se":return[aN.x2,aN.y2];case"sw":return[aN.x,aN.y2]}}function aK(){if(!L.aspectRatio){return aH()}var aO=L.aspectRatio,aV=L.minSize[0]/P,aN=L.maxSize[0]/P,aY=L.maxSize[1]/f,aP=ax-ay,aX=aI-aJ,aQ=Math.abs(aP),aR=Math.abs(aX),aT=aQ/aR,aM,aU,aW,aS;if(aN===0){aN=T*10}if(aY===0){aY=R*10}if(aT<aO){aU=aI;aW=aR*aO;aM=aP<0?ay-aW:aW+ay;if(aM<0){aM=0;aS=Math.abs((aM-ay)/aO);aU=aX<0?aJ-aS:aS+aJ}else{if(aM>T){aM=T;aS=Math.abs((aM-ay)/aO);aU=aX<0?aJ-aS:aS+aJ}}}else{aM=ax;aS=aQ/aO;aU=aX<0?aJ-aS:aJ+aS;if(aU<0){aU=0;aW=Math.abs((aU-aJ)*aO);aM=aP<0?ay-aW:aW+ay}else{if(aU>R){aU=R;aW=Math.abs(aU-aJ)*aO;aM=aP<0?ay-aW:aW+ay}}}if(aM>ay){if(aM-ay<aV){aM=ay+aV}else{if(aM-ay>aN){aM=ay+aN}}if(aU>aJ){aU=aJ+(aM-ay)/aO}else{aU=aJ-(aM-ay)/aO}}else{if(aM<ay){if(ay-aM<aV){aM=ay-aV}else{if(ay-aM>aN){aM=ay-aN}}if(aU>aJ){aU=aJ+(ay-aM)/aO}else{aU=aJ-(ay-aM)/aO}}}if(aM<0){ay-=aM;aM=0}else{if(aM>T){ay-=aM-T;aM=T}}if(aU<0){aJ-=aU;aU=0}else{if(aU>R){aJ-=aU-R;aU=R}}return aG(aF(ay,aJ,aM,aU))}function aA(aM){if(aM[0]<0){aM[0]=0}if(aM[1]<0){aM[1]=0}if(aM[0]>T){aM[0]=T}if(aM[1]>R){aM[1]=R}return[aM[0],aM[1]]}function aF(aP,aR,aO,aQ){var aT=aP,aS=aO,aN=aR,aM=aQ;if(aO<aP){aT=aO;aS=aP}if(aQ<aR){aN=aQ;aM=aR}return[aT,aN,aS,aM]}function aH(){var aN=ax-ay,aM=aI-aJ,aO;if(B&&(Math.abs(aN)>B)){ax=(aN>0)?(ay+B):(ay-B)}if(an&&(Math.abs(aM)>an)){aI=(aM>0)?(aJ+an):(aJ-an)}if(W/f&&(Math.abs(aM)<W/f)){aI=(aM>0)?(aJ+W/f):(aJ-W/f)}if(q/P&&(Math.abs(aN)<q/P)){ax=(aN>0)?(ay+q/P):(ay-q/P)}if(ay<0){ax-=ay;ay-=ay}if(aJ<0){aI-=aJ;aJ-=aJ}if(ax<0){ay-=ax;ax-=ax}if(aI<0){aJ-=aI;aI-=aI}if(ax>T){aO=ax-T;ay-=aO;ax-=aO}if(aI>R){aO=aI-R;aJ-=aO;aI-=aO}if(ay>T){aO=ay-R;aI-=aO;aJ-=aO}if(aJ>R){aO=aJ-R;aI-=aO;aJ-=aO}return aG(aF(ay,aJ,ax,aI))}function aG(aM){return{x:aM[0],y:aM[1],x2:aM[2],y2:aM[3],w:aM[2]-aM[0],h:aM[3]-aM[1]}}return{flipCoords:aF,setPressed:aD,setCurrent:aC,getOffset:aL,moveOffset:aw,getCorner:aE,getFixed:aK}}());var d=(function(){var aB=false,aG=a("<div />").css({position:"absolute",zIndex:240,opacity:0}),aA={top:aC(),left:aC().height(R),right:aC().height(R),bottom:aC()};function aI(aJ,aK){aA.left.css({height:n(aK)});aA.right.css({height:n(aK)})}function ay(){return aD(ad.getFixed())}function aD(aJ){aA.top.css({left:n(aJ.x),width:n(aJ.w),height:n(aJ.y)});aA.bottom.css({top:n(aJ.y2),left:n(aJ.x),width:n(aJ.w),height:n(R-aJ.y2)});aA.right.css({left:n(aJ.x2),width:n(T-aJ.x2)});aA.left.css({width:n(aJ.x)})}function aC(){return a("<div />").css({position:"absolute",backgroundColor:L.shadeColor||L.bgColor}).appendTo(aG)}function az(){if(!aB){aB=true;aG.insertBefore(at);ay();Z.setBgOpacity(1,0,1);M.hide();aF(L.shadeColor||L.bgColor,1);if(Z.isAwake()){ax(L.bgOpacity,1)}else{ax(1,1)}}}function aF(aJ,aK){h(aw(),aJ,aK)}function aH(){if(aB){aG.remove();M.show();aB=false;if(Z.isAwake()){Z.setBgOpacity(L.bgOpacity,1,1)}else{Z.setBgOpacity(1,1,1);Z.disableHandles()}h(ac,0,1)}}function ax(aK,aJ){if(aB){if(L.bgFade&&!aJ){aG.animate({opacity:1-aK},{queue:false,duration:L.fadeTime})}else{aG.css({opacity:1-aK})}}}function aE(){L.shade?az():aH();if(Z.isAwake()){ax(L.bgOpacity)}}function aw(){return aG.children()}return{update:ay,updateRaw:aD,getShades:aw,setBgColor:aF,enable:az,disable:aH,resize:aI,refresh:aE,opacity:ax}}());var Z=(function(){var aH,aQ=370,aD={},aT={},ay={},aA=false;function aE(aX){var aY=a("<div />").css({position:"absolute",opacity:L.borderOpacity}).addClass(G(aX));m.append(aY);return aY}function az(aX,aY){var aZ=a("<div />").mousedown(c(aX)).css({cursor:aX+"-resize",position:"absolute",zIndex:aY}).addClass("ord-"+aX);if(V.support){aZ.bind("touchstart.jcrop",V.createDragger(aX))}O.append(aZ);return aZ}function aI(aX){var aY=L.handleSize;return az(aX,aQ++).css({opacity:L.handleOpacity}).width(aY).height(aY).addClass(G("handle"))}function aO(aX){return az(aX,aQ++).addClass("jcrop-dragbar")}function aL(aX){var aY;for(aY=0;aY<aX.length;aY++){ay[aX[aY]]=aO(aX[aY])}}function aP(aX){var aY,aZ;for(aZ=0;aZ<aX.length;aZ++){switch(aX[aZ]){case"n":aY="hline";break;case"s":aY="hline bottom";break;case"e":aY="vline right";break;case"w":aY="vline";break}aD[aX[aZ]]=aE(aY)}}function aK(aX){var aY;for(aY=0;aY<aX.length;aY++){aT[aX[aY]]=aI(aX[aY])}}function aG(aX,aY){if(!L.shade){M.css({top:n(-aY),left:n(-aX)})}C.css({top:n(aY),left:n(aX)})}function aW(aX,aY){C.width(aX).height(aY)}function aB(){var aX=ad.getFixed();ad.setPressed([aX.x,aX.y]);ad.setCurrent([aX.x2,aX.y2]);aU()}function aU(aX){if(aH){return aF(aX)}}function aF(aX){var aY=ad.getFixed();aW(aY.w,aY.h);aG(aY.x,aY.y);if(L.shade){d.updateRaw(aY)}aH||aV();if(aX){L.onSelect.call(i,ab(aY))}else{L.onChange.call(i,ab(aY))}}function ax(aY,aZ,aX){if(!aH&&!aZ){return}if(L.bgFade&&!aX){at.animate({opacity:aY},{queue:false,duration:L.fadeTime})}else{at.css("opacity",aY)}}function aV(){C.show();if(L.shade){d.opacity(ae)}else{ax(ae,true)}aH=true}function aR(){aS();C.hide();if(L.shade){d.opacity(1)}else{ax(1)}aH=false;L.onRelease.call(i)}function aw(){if(aA){O.show()}}function aM(){aA=true;if(L.allowResize){O.show();return true}}function aS(){aA=false;O.hide()}function aN(aX){if(F===aX){aS()}else{aM()}}function aJ(){aN(false);aB()}if(L.dragEdges&&a.isArray(L.createDragbars)){aL(L.createDragbars)}if(a.isArray(L.createHandles)){aK(L.createHandles)}if(L.drawBorders&&a.isArray(L.createBorders)){aP(L.createBorders)}a(document).bind("touchstart.jcrop-ios",function(aX){if(a(aX.currentTarget).hasClass("jcrop-tracker")){aX.stopPropagation()}});var aC=ai().mousedown(c("move")).css({cursor:"move",position:"absolute",zIndex:360});if(V.support){aC.bind("touchstart.jcrop",V.createDragger("move"))}m.append(aC);aS();return{updateVisible:aU,update:aF,release:aR,refresh:aB,isAwake:function(){return aH},setCursor:function(aX){aC.css("cursor",aX)},enableHandles:aM,enableOnly:function(){aA=true},showHandles:aw,disableHandles:aS,animMode:aN,setBgOpacity:ax,done:aJ}}());var S=(function(){var ax=function(){},az=function(){},ay=L.trackDocument;function aG(){b.css({zIndex:450});if(V.support){a(document).bind("touchmove.jcrop",aF).bind("touchend.jcrop",aC)}if(ay){a(document).bind("mousemove.jcrop",aw).bind("mouseup.jcrop",aA)}}function aE(){b.css({zIndex:290});a(document).unbind(".jcrop")}function aw(aH){ax(J(aH));return false}function aA(aH){aH.preventDefault();aH.stopPropagation();if(s){s=false;az(J(aH));if(Z.isAwake()){L.onSelect.call(i,ab(ad.getFixed()))}aE();ax=function(){};az=function(){}}return false}function aB(aI,aH){s=true;ax=aI;az=aH;aG();return false}function aF(aH){aH.pageX=aH.originalEvent.changedTouches[0].pageX;aH.pageY=aH.originalEvent.changedTouches[0].pageY;return aw(aH)}function aC(aH){aH.pageX=aH.originalEvent.changedTouches[0].pageX;aH.pageY=aH.originalEvent.changedTouches[0].pageY;return aA(aH)}function aD(aH){b.css("cursor",aH)}if(!ay){b.mousemove(aw).mouseup(aA).mouseout(aA)}at.before(b);return{activateHandlers:aB,setCursor:aD}}());var ar=(function(){var az=a('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}),aB=a("<div />").css({position:"absolute",overflow:"hidden"}).append(az);function ax(){if(L.keySupport){az.show();az.focus()}}function aA(aC){az.hide()}function ay(aD,aC,aE){if(L.allowMove){ad.moveOffset([aC,aE]);Z.updateVisible(true)}aD.preventDefault();aD.stopPropagation()}function aw(aD){if(aD.ctrlKey||aD.metaKey){return true}af=aD.shiftKey?true:false;var aC=af?10:1;switch(aD.keyCode){case 37:ay(aD,-aC,0);break;case 39:ay(aD,aC,0);break;case 38:ay(aD,0,-aC);break;case 40:ay(aD,0,aC);break;case 27:if(L.allowSelect){Z.release()}break;case 9:return true}return false}if(L.keySupport){az.keydown(aw).blur(aA);if(aj||!L.fixedSupport){az.css({position:"absolute",left:"-20px"});aB.append(az).insertBefore(at)}else{az.insertBefore(at)}}return{watchKeys:ax}}());function l(aw){ac.removeClass().addClass(G("holder")).addClass(aw)}function u(aP,aD){var aJ=aP[0]/P,ay=aP[1]/f,aI=aP[2]/P,ax=aP[3]/f;if(F){return}var aH=ad.flipCoords(aJ,ay,aI,ax),aN=ad.getFixed(),aK=[aN.x,aN.y,aN.x2,aN.y2],aA=aK,az=L.animationDelay,aM=aH[0]-aK[0],aC=aH[1]-aK[1],aL=aH[2]-aK[2],aB=aH[3]-aK[3],aG=0,aE=L.swingSpeed;x=aA[0];y=aA[1];aI=aA[2];ax=aA[3];Z.animMode(true);var aw;function aF(){window.setTimeout(aO,az)}var aO=(function(){return function(){aG+=(100-aG)/aE;aA[0]=x+((aG/100)*aM);aA[1]=y+((aG/100)*aC);aA[2]=aI+((aG/100)*aL);aA[3]=ax+((aG/100)*aB);if(aG>=99.8){aG=100}if(aG<100){ao(aA);aF()}else{Z.done();if(typeof(aD)==="function"){aD.call(i)}}}}());aF()}function N(aw){ao([aw[0]/P,aw[1]/f,aw[2]/P,aw[3]/f]);L.onSelect.call(i,ab(ad.getFixed()));Z.enableHandles()}function ao(aw){ad.setPressed([aw[0],aw[1]]);ad.setCurrent([aw[2],aw[3]]);Z.update()}function k(){return ab(ad.getFixed())}function am(){return ad.getFixed()}function z(aw){D(aw);Q()}function A(){L.disabled=true;Z.disableHandles();Z.setCursor("default");S.setCursor("default")}function Y(){L.disabled=false;Q()}function o(){Z.done();S.activateHandlers(null,null)}function ak(){ac.remove();aa.show();a(e).removeData("Jcrop")}function au(ax,ay){Z.release();A();var aw=new Image();aw.onload=function(){var az=aw.width;var aB=aw.height;var aC=L.boxWidth;var aA=L.boxHeight;at.width(az).height(aB);at.attr("src",ax);M.attr("src",ax);X(at,aC,aA);T=at.width();R=at.height();M.width(T).height(R);b.width(T+(v*2)).height(R+(v*2));ac.width(T).height(R);d.resize(T,R);Y();if(typeof(ay)==="function"){ay.call(i)}};aw.src=ax}function h(az,aw,ax){var ay=aw||L.bgColor;if(L.bgFade&&H()&&L.fadeTime&&!ax){az.animate({backgroundColor:ay},{queue:false,duration:L.fadeTime})}else{az.css("backgroundColor",ay)}}function Q(aw){if(L.allowResize){if(aw){Z.enableOnly()}else{Z.enableHandles()}}else{Z.disableHandles()}S.setCursor(L.allowSelect?"crosshair":"default");Z.setCursor(L.allowMove?"move":"default");if(L.hasOwnProperty("trueSize")){P=L.trueSize[0]/T;f=L.trueSize[1]/R}if(L.hasOwnProperty("setSelect")){N(L.setSelect);Z.done();delete (L.setSelect)}d.refresh();if(L.bgColor!=ap){h(L.shade?d.getShades():ac,L.shade?(L.shadeColor||L.bgColor):L.bgColor);ap=L.bgColor}if(ae!=L.bgOpacity){ae=L.bgOpacity;if(L.shade){d.refresh()}else{Z.setBgOpacity(ae)}}B=L.maxSize[0]||0;an=L.maxSize[1]||0;q=L.minSize[0]||0;W=L.minSize[1]||0;if(L.hasOwnProperty("outerImage")){at.attr("src",L.outerImage);delete (L.outerImage)}Z.refresh()}if(V.support){b.bind("touchstart.jcrop",V.newSelection)}O.hide();Q(true);var i={setImage:au,animateTo:u,setSelect:N,setOptions:z,tellSelect:k,tellScaled:am,setClass:l,disable:A,enable:Y,cancel:o,release:Z.release,destroy:ak,focus:ar.watchKeys,getBounds:function(){return[T*P,R*f]},getWidgetSize:function(){return[T,R]},getScaleFactor:function(){return[P,f]},getOptions:function(){return L},ui:{holder:ac,selection:C}};if(a.browser.msie){ac.bind("selectstart",function(){return false})}aa.data("Jcrop",i);return i};a.fn.Jcrop=function(b,d){var c;this.each(function(){if(a(this).data("Jcrop")){if(b==="api"){return a(this).data("Jcrop")}else{a(this).data("Jcrop").setOptions(b)}}else{if(this.tagName=="IMG"){a.Jcrop.Loader(this,function(){a(this).css({display:"block",visibility:"hidden"});c=a.Jcrop(this,b);if(a.isFunction(d)){d.call(c)}})}else{a(this).css({display:"block",visibility:"hidden"});c=a.Jcrop(this,b);if(a.isFunction(d)){d.call(c)}}}});return this};a.Jcrop.Loader=function(f,g,c){var d=a(f),b=d[0];function e(){if(b.complete){d.unbind(".jcloader");if(a.isFunction(g)){g.call(b)}}else{window.setTimeout(e,50)}}d.bind("load.jcloader",e).bind("error.jcloader",function(h){d.unbind(".jcloader");if(a.isFunction(c)){c.call(b)}});if(b.complete&&a.isFunction(g)){d.unbind(".jcloader");g.call(b)}};a.Jcrop.defaults={allowSelect:true,allowMove:true,allowResize:true,trackDocument:true,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:0.6,bgFade:false,borderOpacity:0.4,handleOpacity:0.5,handleSize:7,aspectRatio:0,keySupport:true,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:true,dragEdges:true,fixedSupport:true,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}}(jQuery));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}


